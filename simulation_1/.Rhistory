beta1_col <- as.data.frame(beta1_im)
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
legend.position = "none") +
guides(fill = guide_colourbar(barwidth = 1, barheight = 26.25))
library(ggplot2)
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
legend.position = "none") +
guides(fill = guide_colourbar(barwidth = 1, barheight = 26.25))
Packages <- c("ggplot2","colorRamps")
# install.packages(Packages)
invisible(lapply(Packages, library, character.only = TRUE))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
legend.position = "none") +
guides(fill = guide_colourbar(barwidth = 1, barheight = 26.25))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
legend.position = "none") +
guides(fill = guide_colourbar(barwidth = 1, barheight = 26.25))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 26.25))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 27))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 30))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 29))
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 28.5))
beta1_col <- as.data.frame(beta_1)
beta1_col
ggplot(beta1_col, aes(x, y)) +
geom_raster(aes(fill = value)) +
scale_fill_gradientn(colors = blue2green2red(400)) + # in package colorRamps
theme(legend.title=element_blank(),
panel.background = element_rect(colour = "white", fill=NA, size=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin = margin(0, 0, 0, 0, "cm"),
axis.title.x=element_blank(),
axis.text.x =element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y =element_blank(),
axis.ticks.y=element_blank(),
legend.text=element_text(size=14),
# legend.position = c(1.03,0.51),
# legend.position = "none"
) +
guides(fill = guide_colourbar(barwidth = 1, barheight = 28.5))
beta1_col1 <- beta1_col
beta1_col2 <- as.data.frame(beta1_im)
dim(beta1_col1)
dim(beta1_col2)
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("ggplot2","colorRamps")
# install.packages(Packages)
invisible(lapply(Packages, library, character.only = TRUE))
library(ggplot2)
# 2 Visualization of result ----
# Load data ----
setwd("~/Documents/3_Research/201810_GWR/script/1_simulation_mgwrpaper/design_1")
load(file = "100timesresult.RData")
m=100
RMSE_beta_0_df <- RMSE_beta_1_df <- RMSE_beta_2_df <- RMSE_y_df <- c()
for(j in 1:m){
RMSE_beta_0_df <- rbind(RMSE_beta_0_df,
cbind(result[[j]]$RMSE_beta_0, rownames(result[[j]])))
RMSE_beta_1_df <- rbind(RMSE_beta_1_df,
cbind(result[[j]]$RMSE_beta_1, rownames(result[[j]])))
RMSE_beta_2_df <- rbind(RMSE_beta_2_df,
cbind(result[[j]]$RMSE_beta_2, rownames(result[[j]])))
RMSE_y_df      <- rbind(RMSE_y_df,
cbind(result[[j]]$RMSE, rownames(result[[j]])))
}
colnames(RMSE_beta_0_df) <- colnames(RMSE_beta_1_df) <- colnames(RMSE_beta_2_df) <- colnames(RMSE_y_df) <- c("value", "method")
RMSE_beta_0_df <- as.data.frame(RMSE_beta_0_df)
RMSE_beta_1_df <- as.data.frame(RMSE_beta_1_df)
RMSE_beta_2_df <- as.data.frame(RMSE_beta_2_df)
RMSE_y_df       <- as.data.frame(RMSE_y_df)
RMSE_beta_0_df$name <- "beta_0"
RMSE_beta_1_df$name <- "beta_1"
RMSE_beta_2_df$name <- "beta_2"
RMSE_y_df$name       <- "y"
RMSE_beta_0_df$value <- as.numeric(as.character(RMSE_beta_0_df$value))
RMSE_beta_1_df$value <- as.numeric(as.character(RMSE_beta_1_df$value))
RMSE_beta_2_df$value <- as.numeric(as.character(RMSE_beta_2_df$value))
RMSE_y_df$value       <- as.numeric(as.character(RMSE_y_df$value))
levels(RMSE_beta_0_df$method)[4] <- "Ours"
levels(RMSE_beta_1_df$method)[4] <- "Ours"
levels(RMSE_beta_2_df$method)[4] <- "Ours"
levels(RMSE_y_df$method)[4] <- "Ours"
levels(RMSE_beta_0_df$method)[5] <- "Ours (single-scale)"
levels(RMSE_beta_1_df$method)[5] <- "Ours (single-scale)"
levels(RMSE_beta_2_df$method)[5] <- "Ours (single-scale)"
levels(RMSE_y_df$method)[5] <- "Ours (single-scale)"
RMSE_beta_0_df$method <- factor(RMSE_beta_0_df$method, levels = c("Ours", "Ours (single-scale)", "MGWR", "GWR", "ESF"))
RMSE_beta_1_df$method <- factor(RMSE_beta_1_df$method, levels = c("Ours", "Ours (single-scale)", "MGWR", "GWR", "ESF"))
RMSE_beta_2_df$method <- factor(RMSE_beta_2_df$method, levels = c("Ours", "Ours (single-scale)", "MGWR", "GWR", "ESF"))
RMSE_y_df$method <- factor(RMSE_y_df$method, levels = c("Our", "Our (single-scale)", "MGWR", "GWR", "ESF"))
RMSE_beta <- list(RMSE_beta_0_df, RMSE_beta_1_df, RMSE_beta_2_df)
name_vt <- c("beta0","beta1","beta2")
# beta ----
RMSE_boxplot<-list()
ggplot(data = RMSE_beta[[i]],aes(x = name, y=value, fill=method)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
i=1
ggplot(data = RMSE_beta[[i]],aes(x = name, y=value, fill=method)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
dim(mrts)
dim(mtrs)
dim(mtcars)
mtcars[1:2,]
knitr::opts_chunk$set(echo = TRUE)
Packages <- c("ggplot2","colorRamps", "tidyr")
# install.packages(Packages)
invisible(lapply(Packages, library, character.only = TRUE))
cbind(rownames(mtcars, mtcars[,c(4,5,6,4,6)])
)
mtcars[,c(4,5,6,4,6)]
cbind(rownames(mtcars), mtcars[,c(4,5,6,4,6)]))
cbind(rownames(mtcars), mtcars[,c(4,5,6,4,6)]))
cbind(rownames(mtcars), mtcars[,c(4,5,6,4,6)])
colnames(mtcars[,c(4,5,6,4,6)])
df <- gather(mtcars[,c(4,5,6,4,6)], value, hp:wt.1)
df <- gather(mtcars[,c(4,5,6,4,6)],name, value, hp:wt.1)
df
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black"))
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
# ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black"))
colnames(iris[,c(1,2,3,4,1)])
df <- gather(iris[,c(1,2,3,4,1)],name, value, Sepal.Length:Sepal.Length.1)
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
# ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black"))
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
# ylim(c(0,0.25)) +
scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
# ylim(c(0,0.25)) +
# scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
# ylim(c(0,0.25)) +
# scale_x_discrete(labels = "") +
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0, 10)) +
scale_x_discrete(labels = "") + # remove x lab
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0, 10)) +
scale_x_discrete(labels = "") + # remove x lab
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.235, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0, 10)) +
scale_x_discrete(labels = "") + # remove x lab
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.2, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
setwd("~/Documents/3_Research/201810_GWR/script/1_simulation_mgwrpaper/design_1")
df <- gather(iris[,c(1,2,3,4,1)],name, value, Sepal.Length:Sepal.Length.1)
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0, 10)) +
scale_x_discrete(labels = "") + # remove x lab
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.2, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
df <- gather(iris[,c(1,2,3,4,1)],name, value, Sepal.Length:Sepal.Length.1)
ggplot(data = df,aes(x = name, y=value, fill=name)) +
geom_boxplot() +
xlab("") +
ylab("") +
ylim(c(0, 10)) +
scale_x_discrete(labels = "") + # remove x lab
scale_fill_manual(name = "",values=c("white", "grey90", "grey50", "grey30", "black")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill=NA),
legend.position = c(0.2, 0.85),
# axis.text.x=element_text(size=16),
axis.text.y=element_text(size=14),
axis.title=element_text(size=14),
legend.text = element_text(size=14),
legend.title = element_text(size=14),
legend.key = element_blank(),
axis.ticks.length = unit(0, "mm"), # remove a vertical line on x-axis
axis.title.x=element_blank()) # remove x-lab position
